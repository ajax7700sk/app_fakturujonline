{"version":3,"sources":["main.js"],"names":["document","addEventListener","event","bootstrapInit","taxDocument","datagrid","$","body","on","e","$this","target","attr","$target","hasClass","removeClass","addClass","toolbar","parent","find","modal","val","addItem","template","html","index","length","replace","append","recalculateLineItemsTotals","each","item","$tr","quantity","parseFloat","unitPriceTaxExcl","taxRate","isNaN","unitPriceTaxIncl","totalPriceTaxExcl","totalPriceTaxIncl","recalculateTotals","$btn","parents","remove","id","value","url","ajax","data","method","dataType","complete","xhr","responseJSON","key"],"mappings":"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","sourcesContent":["/*\r\n * Welcome to your app's main JavaScript file!\r\n *\r\n * We recommend including the built version of this JavaScript file\r\n * (and its CSS file) in your base layout (base.html.twig).\r\n */\r\n\r\n// import Datagird from \"./components/Datagrid\";\r\n// import Toolbar from \"./components/Toolbar\";\r\n\r\ndocument.addEventListener('DOMContentLoaded', (event) => {\r\n    //\r\n    bootstrapInit()\r\n    //\r\n    taxDocument();\r\n});\r\n\r\n\r\n\r\n/**\r\n * Bootstrap functions\r\n */\r\nfunction bootstrapInit() {\r\n    function datagrid() {\r\n        // Datagrid fix\r\n        $(document.body).on('click', \"[data-toggle='collapse']\", function(e) {\r\n            $this = $(e.target);\r\n            const target = $this.attr('data-target');\r\n            var $target = $(target);\r\n\r\n            if($target.hasClass('show')) {\r\n                $target.removeClass('show');\r\n            } else {\r\n                $target.addClass('show');\r\n            }\r\n        });\r\n    }\r\n\r\n    function toolbar() {\r\n        $(document.body).on('click', '.nav-link', function () {\r\n            $('.nav-link').parent().find('.nav-link').removeClass('active');\r\n            //\r\n            $(this).addClass('active');\r\n            //\r\n            const target = $(this).attr('data-bs-target');\r\n            //\r\n            $('.tab-pane').removeClass('.show').removeClass('active');\r\n            //\r\n            $('.tab-content')\r\n                .find(target)\r\n                .addClass('show')\r\n                .addClass('active');\r\n        });\r\n    }\r\n\r\n    function modal() {\r\n        $(document.body).on('click', [\"data-toggle='toggle'\"], function(e) {\r\n            var $this = $(e.target);\r\n            var $target = $($this.attr('data-target'));\r\n            //\r\n            // has id?\r\n            if($this.attr('data-id')) {\r\n                $target.find('form .js-data-id').val($this.attr('data-id'));\r\n            }\r\n            //\r\n            $target.modal('show');\r\n        })\r\n\r\n        $(document.body).on('click', '.js-modal-close', function(e) {\r\n            $('.modal').modal('hide');\r\n        })\r\n    }\r\n\r\n    // Init\r\n    datagrid();\r\n    toolbar();\r\n    modal();\r\n}\r\n\r\n// Tax document\r\nfunction taxDocument() {\r\n    function addItem() {\r\n        // Copy template\r\n        let template = $('#tax-document-item-template').find('tbody').html();\r\n        // Replace index\r\n        let index = $('.js-tax-document-rows').find('tr').length;\r\n        template = template.replace(/_index_/g, index);\r\n        //\r\n        $('.js-tax-document-rows').append(template);\r\n    }\r\n\r\n    function recalculateLineItemsTotals() {\r\n        $('.js-tax-document-rows tr').each(function(item) {\r\n            var $tr = $(this);\r\n            //\r\n            var quantity = parseFloat($tr.find('.js-quantity').val());\r\n            var unitPriceTaxExcl = parseFloat($tr.find('.js-unit-price-tax-excl').val());\r\n            var taxRate = parseFloat($tr.find('.js-tax-rate').val());\r\n            //\r\n            quantity = isNaN(quantity) ? 0 : quantity;\r\n            unitPriceTaxExcl = isNaN(unitPriceTaxExcl) ? 0 : unitPriceTaxExcl;\r\n            taxRate = isNaN(taxRate) ? 0 : taxRate;\r\n            //\r\n            var unitPriceTaxIncl = unitPriceTaxExcl * (1 + (taxRate / 100));\r\n            var totalPriceTaxExcl = unitPriceTaxExcl * quantity;\r\n            var totalPriceTaxIncl = unitPriceTaxIncl * quantity;\r\n            //\r\n            $tr.find('.js-item-total').val(totalPriceTaxIncl);\r\n        });\r\n    }\r\n\r\n    function recalculateTotals() {\r\n        // Line Items\r\n        recalculateLineItemsTotals();\r\n        // Recalculate totals\r\n    }\r\n\r\n    // ----------------------------------- Events ------------------------------------- \\\\\r\n\r\n    // Add item\r\n    $(document.body).on('click', '.js-add-item', function() {\r\n        addItem();\r\n        //\r\n        recalculateTotals();\r\n    })\r\n\r\n    // Remove item\r\n    $(document.body).on('click', '.js-remove-item', function(e) {\r\n        var $btn = $(e.target);\r\n        var $tr = $btn.parents('tr');\r\n        //\r\n        // Can delete?\r\n        $tr.remove();\r\n    });\r\n\r\n    // Change quantity\r\n    $(document.body).on('change', '.js-quantity', function(e) {\r\n        recalculateTotals();\r\n    })\r\n\r\n    // Change tax rate\r\n    $(document.body).on('change', '.js-tax-rate', function(e) {\r\n        recalculateTotals();\r\n    })\r\n\r\n    $(document.body).on('change', '.js-unit-price-tax-excl', function(e) {\r\n        recalculateTotals();\r\n    })\r\n\r\n    // Load company data\r\n    $(document.body).on('change', '#frm-taxDocumentForm-form-userCompany', function (e) {\r\n        var id = e.target.value;\r\n        var url = $(this).parent('.js-load-company-data').attr('data-link');\r\n        //\r\n        $.ajax( {\r\n            url: url,\r\n            data: {\r\n                id: id\r\n            },\r\n            method: 'POST',\r\n            dataType: 'json',\r\n            complete: function(xhr) {\r\n                var data = xhr.responseJSON;\r\n                //\r\n                for (var key in data) {\r\n                    var value = data[key];\r\n                    // Set value\r\n                    $(\"input[name=\"+key+\"]\").val(value);\r\n                }\r\n            }\r\n        })\r\n    });\r\n}"],"file":"main.8c4a448908.js"}